<header class="header">
    <div class="header-container">
        <!-- Logo -->
        <a routerLink="/" class="logo">
            <span class="logo-icon">üåø</span>
            <span class="logo-text">TreeShop</span>
        </a>

        <!-- Navigation -->
        <nav class="nav-menu">
            <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">Trang ch·ªß</a>
            <a routerLink="/products" routerLinkActive="active">S·∫£n ph·∫©m</a>
            <a routerLink="/about" routerLinkActive="active">V·ªÅ ch√∫ng t√¥i</a>
        </nav>

        <!-- Actions -->
        <div class="header-actions">
            <!-- Search -->
            <button class="icon-btn search-btn" (click)="toggleSearch()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </button>

            <!-- Cart -->
            <a routerLink="/cart" class="icon-btn cart-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="m1 1 4 4 15.2 1.9a1 1 0 0 1 .8 1l-1.5 6.8a1 1 0 0 1-1 .8H7.8"></path>
                </svg>
                @if (cartService.cartCount() > 0) {
                <span class="cart-badge">{{ cartService.cartCount() }}</span>
                }
            </a>

            <!-- User Menu -->
            @if (authService.isLoggedIn()) {
            <div class="user-menu">
                <button class="user-btn" (click)="toggleUserMenu()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </button>
                @if (showUserMenu) {
                <div class="user-dropdown">
                    <a routerLink="/profile">T√†i kho·∫£n</a>
                    <a routerLink="/orders">ƒê∆°n h√†ng</a>
                    <button (click)="logout()">ƒêƒÉng xu·∫•t</button>
                </div>
                }
            </div>
            } @else {
            <a routerLink="/login" class="login-btn">ƒêƒÉng nh·∫≠p</a>
            }

            <!-- Mobile Menu Toggle -->
            <button class="mobile-menu-btn" (click)="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </div>

    <!-- Search Bar (expandable) -->
    @if (showSearch) {
    <div class="search-bar">
        <input type="text" placeholder="T√¨m ki·∫øm c√¢y c·∫£nh..." #searchInput>
        <button (click)="search(searchInput.value)">T√¨m</button>
    </div>
    }

    <!-- Mobile Menu -->
    @if (showMobileMenu) {
    <nav class="mobile-nav">
        <a routerLink="/" (click)="closeMobileMenu()">Trang ch·ªß</a>
        <a routerLink="/products" (click)="closeMobileMenu()">S·∫£n ph·∫©m</a>
        <a routerLink="/about" (click)="closeMobileMenu()">V·ªÅ ch√∫ng t√¥i</a>
    </nav>
    }
</header>